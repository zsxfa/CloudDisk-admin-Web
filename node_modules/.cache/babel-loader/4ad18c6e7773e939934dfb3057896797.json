{"remainingRequest":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\babel-loader\\lib\\index.js!D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\src\\store\\modules\\user.js","mtime":1649302923107},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\.babelrc","mtime":1649302887736},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649302895478},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649302893135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKaW1wb3J0IHsgbG9naW4sIGxvZ291dCwgZ2V0SW5mbyB9IGZyb20gJ0AvYXBpL2xvZ2luJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIGJ1dHRvbnM6IFtdLAogICAgcm9sZXM6IFtdCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgfSwKICAgIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICAgIH0sCiAgICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogICAgfSwKICAgIFNFVF9CVVRUT05TOiBmdW5jdGlvbiBTRVRfQlVUVE9OUyhzdGF0ZSwgYnV0dG9ucykgewogICAgICBzdGF0ZS5idXR0b25zID0gYnV0dG9uczsKICAgIH0sCiAgICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgICAgc3RhdGUucm9sZXMgPSByb2xlczsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIC8vIOeZu+W9lQogICAgTG9naW46IGZ1bmN0aW9uIExvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgICAgZGVidWdnZXI7CiAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLnRyaW0oKTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBsb2dpbih1c2VybmFtZSwgdXNlckluZm8ucGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAvLyBkZWJ1Z2dlcgogICAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIGRhdGEudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6I635Y+W55So5oi35L+h5oGvCiAgICBHZXRJbmZvOiBmdW5jdGlvbiBHZXRJbmZvKF9yZWYyKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBjb21taXQsIHN0YXRlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMi5jb21taXQsIHN0YXRlID0gX3JlZjIuc3RhdGU7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICAgIGdldEluZm8oc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gZGVidWdnZXIKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnJvbGVzICYmIGRhdGEucm9sZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgLy8g6aqM6K+B6L+U5Zue55qEcm9sZXPmmK/lkKbmmK/kuIDkuKrpnZ7nqbrmlbDnu4QKICAgICAgICAgICAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgZGF0YS5yb2xlcyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnZ2V0SW5mbzogcm9sZXMgbXVzdCBiZSBhIG5vbi1udWxsIGFycmF5ICEnKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHZhciBidXR0b25BdXRoTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgIGRhdGEucGVybWlzc2lvblZhbHVlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24pIHsKICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbkF1dGhMaXN0LnB1c2goYnV0dG9uKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgZGF0YS5uYW1lKTsKICAgICAgICAgICAgICAgICAgICBjb21taXQoJ1NFVF9BVkFUQVInLCBkYXRhLmF2YXRhcik7CiAgICAgICAgICAgICAgICAgICAgY29tbWl0KCdTRVRfQlVUVE9OUycsIGJ1dHRvbkF1dGhMaXN0KTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBMb2dPdXQ6IGZ1bmN0aW9uIExvZ091dChfcmVmMykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBsb2dvdXQoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgZGVidWdnZXI7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsgLy8g5riF56m65YmN56uvdnVleOS4reWtmOWCqOeahOaVsOaNrgoKICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgW10pOyAvLyDmuIXnqbrliY3nq692dWV45Lit5a2Y5YKo55qE5pWw5o2uCgogICAgICAgICAgY29tbWl0KCdTRVRfQlVUVE9OUycsIFtdKTsKICAgICAgICAgIHJlbW92ZVRva2VuKCk7IC8vIOa4heepumNvb2tpZQoKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWJjeerryDnmbvlh7oKICAgIEZlZExvZ091dDogZnVuY3Rpb24gRmVkTG9nT3V0KF9yZWY0KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGRlYnVnZ2VyOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgIHJlbW92ZVRva2VuKCk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IHVzZXI7"},{"version":3,"sources":["D:/Developer/bishe/front/CloudDisk-admin-web/src/store/modules/user.js"],"names":["login","logout","getInfo","getToken","setToken","removeToken","user","state","token","name","avatar","buttons","roles","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_BUTTONS","SET_ROLES","actions","Login","userInfo","commit","username","trim","Promise","resolve","reject","password","then","response","data","catch","error","GetInfo","length","buttonAuthList","permissionValueList","forEach","button","push","LogOut","FedLogOut"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '@/api/login'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    buttons: [],\r\n    roles: [],\r\n  },\r\n\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_BUTTONS: (state, buttons) => {\r\n      state.buttons = buttons\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    },\r\n  },\r\n\r\n  actions: {\r\n    // 登录\r\n    Login({ commit }, userInfo) {\r\n      debugger\r\n      const username = userInfo.username.trim()\r\n      return new Promise((resolve, reject) => {\r\n        login(username, userInfo.password)\r\n          .then((response) => {\r\n            // debugger\r\n            const data = response.data\r\n            setToken(data.token)\r\n            commit('SET_TOKEN', data.token)\r\n            resolve()\r\n          })\r\n          .catch((error) => {\r\n            reject(error)\r\n          })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    async GetInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getInfo(state.token)\r\n          .then((response) => {\r\n            // debugger\r\n            const data = response.data\r\n            if (data.roles && data.roles.length > 0) {\r\n              // 验证返回的roles是否是一个非空数组\r\n              commit('SET_ROLES', data.roles)\r\n            } else {\r\n              reject('getInfo: roles must be a non-null array !')\r\n            }\r\n\r\n            const buttonAuthList = []\r\n            data.permissionValueList.forEach((button) => {\r\n              buttonAuthList.push(button)\r\n            })\r\n\r\n            commit('SET_NAME', data.name)\r\n            commit('SET_AVATAR', data.avatar)\r\n            commit('SET_BUTTONS', buttonAuthList)\r\n            resolve(response)\r\n          })\r\n          .catch((error) => {\r\n            reject(error)\r\n          })\r\n      })\r\n    },\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token)\r\n          .then(() => {\r\n            debugger\r\n            commit('SET_TOKEN', '') // 清空前端vuex中存储的数据\r\n            commit('SET_ROLES', []) // 清空前端vuex中存储的数据\r\n            commit('SET_BUTTONS', [])\r\n            removeToken() // 清空cookie\r\n            resolve()\r\n          })\r\n          .catch((error) => {\r\n            reject(error)\r\n          })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise((resolve) => {\r\n        debugger\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    },\r\n  },\r\n}\r\n\r\nexport default user\r\n"]}]}