{"remainingRequest":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\babel-loader\\lib\\index.js!D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\src\\store\\modules\\permission.js","mtime":1649302923105},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\.babelrc","mtime":1649302887736},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1649302895478},{"path":"D:\\Developer\\bishe\\front\\CloudDisk-admin-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1649302893135}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKaW1wb3J0IHsgY29uc3RhbnRSb3V0ZXMgfSBmcm9tICdAL3JvdXRlcic7CmltcG9ydCB7IGdldE1lbnUgfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCBMYXlvdXQgZnJvbSAnQC9sYXlvdXQvTGF5b3V0JzsKCmZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVyKGFzeW5jUm91dGVyTWFwKSB7CiAgLy8g6YGN5Y6G5ZCO5Y+w5Lyg5p2l55qE6Lev55Sx5a2X56ym5Liy77yM6L2s5o2i5Li657uE5Lu25a+56LGhCiAgdHJ5IHsKICAgIHZhciBhY2Nlc3NlZFJvdXRlcnMgPSBhc3luY1JvdXRlck1hcC5maWx0ZXIoZnVuY3Rpb24gKHJvdXRlKSB7CiAgICAgIGlmIChyb3V0ZS5jb21wb25lbnQpIHsKICAgICAgICBpZiAocm91dGUuY29tcG9uZW50ID09PSAnTGF5b3V0JykgewogICAgICAgICAgLy8gTGF5b3V057uE5Lu254m55q6K5aSE55CGCiAgICAgICAgICByb3V0ZS5jb21wb25lbnQgPSBMYXlvdXQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBjb21wb25lbnQgPSByb3V0ZS5jb21wb25lbnQ7CgogICAgICAgICAgcm91dGUuY29tcG9uZW50ID0gZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVxdWlyZShbJ0Avdmlld3MnICsgY29tcG9uZW50ICsgJy52dWUnXSwgcmVzb2x2ZSk7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHJvdXRlLmNoaWxkcmVuICYmIHJvdXRlLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIHJvdXRlLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXIocm91dGUuY2hpbGRyZW4pOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0pOwogICAgcmV0dXJuIGFjY2Vzc2VkUm91dGVyczsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmxvZyhlKTsKICB9Cn0KCnZhciBzdGF0ZSA9IHsKICByb3V0ZXM6IFtdLAogIGFkZFJvdXRlczogW10KfTsKdmFyIG11dGF0aW9ucyA9IHsKICBTRVRfUk9VVEVTOiBmdW5jdGlvbiBTRVRfUk9VVEVTKHN0YXRlLCByb3V0ZXMpIHsKICAgIHN0YXRlLmFkZFJvdXRlcyA9IHJvdXRlczsKICAgIHN0YXRlLnJvdXRlcyA9IGNvbnN0YW50Um91dGVzLmNvbmNhdChyb3V0ZXMpOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgZ2VuZXJhdGVSb3V0ZXM6IGZ1bmN0aW9uIGdlbmVyYXRlUm91dGVzKF9yZWYsIHJvbGVzKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGNvbW1pdCwgYXN5bmNSb3V0ZXI7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGdldE1lbnUoKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBhc3luY1JvdXRlciA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgICAgIHZhciB0bXAgPSBhc3luY1JvdXRlci5kYXRhLnBlcm1pc3Npb25MaXN0OwogICAgICAgICAgICAgICAgdmFyIGFjY2Vzc2VkUm91dGVzID0gZmlsdGVyQXN5bmNSb3V0ZXIodG1wKTsKICAgICAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgICAgICAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},{"version":3,"sources":["D:/Developer/bishe/front/CloudDisk-admin-web/src/store/modules/permission.js"],"names":["constantRoutes","getMenu","Layout","filterAsyncRouter","asyncRouterMap","accessedRouters","filter","route","component","resolve","require","children","length","e","console","log","state","routes","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","roles","commit","asyncRouter","Promise","tmp","data","permissionList","accessedRoutes","namespaced"],"mappings":";;AAAA,SAASA,cAAT,QAA+B,UAA/B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,MAAP,MAAmB,iBAAnB;;AAEA,SAASC,iBAAT,CAA2BC,cAA3B,EAA2C;AACzC;AACA,MAAI;AACF,QAAMC,eAAe,GAAGD,cAAc,CAACE,MAAf,CAAsB,UAACC,KAAD,EAAW;AACvD,UAAIA,KAAK,CAACC,SAAV,EAAqB;AACnB,YAAID,KAAK,CAACC,SAAN,KAAoB,QAAxB,EAAkC;AAChC;AACAD,UAAAA,KAAK,CAACC,SAAN,GAAkBN,MAAlB;AACD,SAHD,MAGO;AACL,cAAMM,SAAS,GAAGD,KAAK,CAACC,SAAxB;;AACAD,UAAAA,KAAK,CAACC,SAAN,GAAkB,UAACC,OAAD,EAAa;AAC7BC,YAAAA,OAAO,CAAC,CAAC,YAAYF,SAAZ,GAAwB,MAAzB,CAAD,EAAmCC,OAAnC,CAAP;AACD,WAFD;AAGD;AACF;;AACD,UAAIF,KAAK,CAACI,QAAN,IAAkBJ,KAAK,CAACI,QAAN,CAAeC,MAArC,EAA6C;AAC3CL,QAAAA,KAAK,CAACI,QAAN,GAAiBR,iBAAiB,CAACI,KAAK,CAACI,QAAP,CAAlC;AACD;;AACD,aAAO,IAAP;AACD,KAhBuB,CAAxB;AAkBA,WAAON,eAAP;AACD,GApBD,CAoBE,OAAOQ,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD;AACF;;AAED,IAAMG,KAAK,GAAG;AACZC,EAAAA,MAAM,EAAE,EADI;AAEZC,EAAAA,SAAS,EAAE;AAFC,CAAd;AAKA,IAAMC,SAAS,GAAG;AAChBC,EAAAA,UAAU,EAAE,oBAACJ,KAAD,EAAQC,MAAR,EAAmB;AAC7BD,IAAAA,KAAK,CAACE,SAAN,GAAkBD,MAAlB;AACAD,IAAAA,KAAK,CAACC,MAAN,GAAejB,cAAc,CAACqB,MAAf,CAAsBJ,MAAtB,CAAf;AACD;AAJe,CAAlB;AAOA,IAAMK,OAAO,GAAG;AACRC,EAAAA,cADQ,gCACmBC,KADnB,EAC0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAjBC,cAAAA,MAAiB,QAAjBA,MAAiB;AAAA;AAAA,qBAGZxB,OAAO,EAHK;;AAAA;AAGhCyB,cAAAA,WAHgC;AAAA,+CAK/B,IAAIC,OAAJ,CAAY,UAAClB,OAAD,EAAa;AAC9B,oBAAMmB,GAAG,GAAGF,WAAW,CAACG,IAAZ,CAAiBC,cAA7B;AACA,oBAAMC,cAAc,GAAG5B,iBAAiB,CAACyB,GAAD,CAAxC;AAEAH,gBAAAA,MAAM,CAAC,YAAD,EAAeM,cAAf,CAAN;AACAtB,gBAAAA,OAAO,CAACsB,cAAD,CAAP;AACD,eANM,CAL+B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYvC;AAba,CAAhB;AAgBA,eAAe;AACbC,EAAAA,UAAU,EAAE,IADC;AAEbhB,EAAAA,KAAK,EAALA,KAFa;AAGbG,EAAAA,SAAS,EAATA,SAHa;AAIbG,EAAAA,OAAO,EAAPA;AAJa,CAAf","sourcesContent":["import { constantRoutes } from '@/router'\r\nimport { getMenu } from '@/api/login'\r\nimport Layout from '@/layout/Layout'\r\n\r\nfunction filterAsyncRouter(asyncRouterMap) {\r\n  // 遍历后台传来的路由字符串，转换为组件对象\r\n  try {\r\n    const accessedRouters = asyncRouterMap.filter((route) => {\r\n      if (route.component) {\r\n        if (route.component === 'Layout') {\r\n          // Layout组件特殊处理\r\n          route.component = Layout\r\n        } else {\r\n          const component = route.component\r\n          route.component = (resolve) => {\r\n            require(['@/views' + component + '.vue'], resolve)\r\n          }\r\n        }\r\n      }\r\n      if (route.children && route.children.length) {\r\n        route.children = filterAsyncRouter(route.children)\r\n      }\r\n      return true\r\n    })\r\n\r\n    return accessedRouters\r\n  } catch (e) {\r\n    console.log(e)\r\n  }\r\n}\r\n\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: [],\r\n}\r\n\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes = constantRoutes.concat(routes)\r\n  },\r\n}\r\n\r\nconst actions = {\r\n  async generateRoutes({ commit }, roles) {\r\n    // 取后台路由\r\n\r\n    const asyncRouter = await getMenu()\r\n\r\n    return new Promise((resolve) => {\r\n      const tmp = asyncRouter.data.permissionList\r\n      const accessedRoutes = filterAsyncRouter(tmp)\r\n\r\n      commit('SET_ROUTES', accessedRoutes)\r\n      resolve(accessedRoutes)\r\n    })\r\n  },\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions,\r\n}\r\n"]}]}